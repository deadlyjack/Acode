(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{535:function(e,t,n){},547:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var a=n(429),r=n.n(a),i=n(457),o=n.n(i),s=n(526),c=n.n(s),l=(n(535),n(1)),p=n.n(l),d=n(62),u=n.n(d),f=n(111),h=n.n(f),g=n(70),b=n(3),v=n(4),m=n(192),y=n(197),w=n(198);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){var a,i=Object(g.a)(t),s=p()("span",{className:"icon more_vert",attr:{action:"toggle-menu"}}),c=p.a.parse('<div class="main" id="repo-tree">\n  <div class="navigation"></div>\n</div>'),l=c.querySelector(".navigation"),d=m.a.GitHub().getRepo(e,t),f=p()("span",{className:"icon search",attr:{action:"search"}}),k={},O={},S=[],j=[],D={id:"from",placeholder:strings["use branch"],hints:function(e){e(j.slice(0,-1))},type:"text"},F={id:"branch",placeholder:strings["new branch"],type:"text",match:/^[a-z\-_0-9]+$/i},L=[],P=Object(y.a)(u.a.render('<li action="info">\n  <span class="text">{{info}}</span>\n  <span class="icon info"></span>\n</li>',strings),{toggle:s,top:"8px",right:"8px",transformOrigin:"top right"});function H(){v.a.loaderShow(t,strings.loading+"..."),d.getSha(a,"").then((function(e){q(e.data,t,"root"),actionStack.push({id:"repo",action:i.hide}),i.onhide=function(){P.removeEventListener("click",E),i.removeEventListener("click",E),actionStack.remove("repo"),S.map((function(e){actionStack.remove(e)}))}})).catch((function(e){b.a.error(e),console.error(e)})).finally((function(){v.a.loaderHide()})),P.addEventListener("click",E),i.addEventListener("click",E),i.append(c),i.querySelector("header").append(f,s),document.body.appendChild(i)}function E(s){var p=s.target,u=p.getAttribute("action");u&&("info"===u&&P.hide(),function(s,p){var u=p.getAttribute("sha"),f=p.getAttribute("name");switch(s){case"folder":g();break;case"file":!function(){v.a.loaderShow(f,strings.loading+"...");var n=b.a.getExt(f),s=h.a.lookup(n),c=/image/i.test(s)?"blob":null;d.getBlob(u,"blob").then(function(){var n=o()(r.a.mark((function n(o){var s,l;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=o.data,c){n.next=28;break}if(!(s instanceof Blob)){n.next=19;break}if(n.prev=3,!s.text){n.next=10;break}return n.next=7,s.text();case 7:s=n.sent,n.next=13;break;case 10:return n.next=12,b.a.blob2text(s);case 12:s=n.sent;case 13:n.next=19;break;case 15:n.prev=15,n.t0=n.catch(3),console.error(n.t0),v.a.alert(strings.error,strings["unable to open file"]);case 19:l=gitRecord.add({sha:u,data:s,name:f,branch:a,repo:t,path:L.slice(1).join("/"),owner:e}),editorManager.addNewFile(f,{type:"git",record:l,text:s,isUnsaved:!1}),i.hide(),window.freeze=!1,actionStack.pop(),actionStack.pop(),window.freeze=!0,n.next=29;break;case 28:"blob"===c?v.a.box(f,"<img src='".concat(URL.createObjectURL(s),"'>")):alert(strings.error.toUpperCase(),strings["file not supported"]);case 29:case"end":return n.stop()}}),n,null,[[3,15]])})));return function(e){return n.apply(this,arguments)}}()).finally((function(){v.a.loaderHide()}))}();break;case"navigate":g();break;case"info":n.e(14).then(n.bind(null,544)).then((function(n){n.default(t,e)}));break;case"search":Object(w.a)(c.get(".list"))}function g(){O.scroll=c.querySelector(".list").scrollTop;var e=O,n=e.sha,a=e.list,r=e.name;u in k?q(k[u].list,f,u):(v.a.loaderShow(t,strings.loading+"..."),d.getTree(u).then((function(e){q(e.data.tree,f,u)})).catch(z).finally(v.a.loaderHide)),actionStack.push({id:n,action:function(){if(q(a,r,n),S.pop(),"folder"===s){var e=l.lastChild;e&&(L.pop(),L.pop(),e.remove())}}}),S.push(n)}}(u,p))}function q(e,n,r){i.settitle(t+" (".concat(a,")")),r in k||e.map((function(e){var t=e.size,n=e.type,a=e.name;e.size=(t/1024).toFixed(2)+"KB",!e.name&&e.path&&(e.name=e.path),e.isDirectory="dir"===n||"tree"===n,e.isFile=!e.isDirectory,e.type=e.isDir?"folder":b.a.getIconForFile(a)})),e=b.a.sortDir(e,{showHiddenFiles:"on",sortByName:"on"});var o=c.querySelector(".list");o&&o.remove();var s=p.a.parse(u.a.render('<div class="list" id="repo-list" empty-message="{{msg}}">{{#list}}{{#.}}\n  <div class="list-item" sha="{{sha}}" name="{{name}}"\n    action="{{#isDirectory}}folder{{/isDirectory}}{{#isFile}}file{{/isFile}}">\n    <span class="icon {{type}}"></span>\n    <span class="container">\n      <div class="text">\n        <span>{{name}}</span>\n      </div>\n      {{#isFile}}\n      <small class="value">{{size}}</small>\n      {{/isFile}}\n    </span>\n  </div>\n  {{/.}}{{/list}}</div>',{msg:strings["empty folder message"],list:e}));c.append(s),r in k&&(s.scrollTop=k[r].scroll||0),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};L.push(e);var a=l.querySelector('[sha="'.concat(t,'"]')),r=l.querySelector(".active");r&&r.classList.remove("active");a?a.classList.add("active"):(a=p()("span",{className:"nav active",attr:x({sha:t,action:"navigate",text:e,name:e},n)}),l.append(a));l.scrollLeft=l.scrollWidth}(n,r),r in k?O=k[r]:(O={list:e,name:n,sha:r},k[r]=O)}function z(e){console.log(e),actionStack.pop(),v.a.alert(strings.error,e.toString())}v.a.loaderShow(t,strings.loading+"..."),d.listBranches().then((function(e){return v.a.loaderHide(),e.data.map((function(e){j.push(e.name)})),j.push(["add",strings["new branch"],"add"]),v.a.select(strings["select branch"],j)})).then((function(e){"add"===e?v.a.multiPrompt(strings["create new branch"],[D,F]).then((function(e){var t=e.from;return a=e.branch,v.a.loaderShow("",strings.loading+"..."),d.createBranch(t,a)})).then(H).catch((function(e){b.a.error(e),console.error(e)})).finally((function(){v.a.loaderHide()})):(a=e,H())})).catch((function(e){b.a.error(e),console.error(e)})).finally((function(e){v.a.loaderHide()}))}}}]);